# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

Разработана программа, реализующая алгоритм "мешок слов", для классификации изображений набора 
данных [dogs-vs-cats](https://www.kaggle.com/competitions/dogs-vs-cats/data). 

##Структура программы

Программа содержит:
- `cli_argument_parser() - парсер аргументов командной строки`
- `load_img - функция загрузки изображений`
- `gray_img - функция перевода изображения в оттенки серого`
- `extract_features - функция, извлекающая дескрипторы признаков из списка изображений`
- `create_visual_dictionary - функция, создающая визуальный словарь из списка дескрипторов 
признаков с использованием алгоритма k-средних`
- `build_histogram - функция, создающая гистограмму визуальных слов`
- `build_feature_vectors - функция, создающая векторы признаков для списка изображений`
- `train_classifier - функция, обучающая классификатор`
- `evaluate_classifier - функция, оценивающая производительность заданного классификатора`
- `train_and_evaluate_classifier - функция, обучающая классификатор и оценивающая его точность`
- `visualize_features - функция, визуализирующая ключевые точки`
- `main() - основная функция программы`

## Описание функций

1. **Функция-парсер аргументов командной строки.** 
- `-t` - путь к директории, содержащей изображения для тестирования
- `-tr` - путь к директории, содержащей изображения для обучения
- `-d` - дескриптор (sift, orb)
- `-n` - число кластеров
- `-cl` - классификатор (svc, rf, knn, gb, lr)

2. **Функция загрузки изображений.**
Данная функция перебирает все файлы в указанной директории, загружает изображение, если 
изображение загружено успешно, то изменяет его размер и присваивает метку. 

3. **Функция перевода изображения в оттенки серого.**
Данная функция преобразует цветные изображения в изображения в оттенках серого.

4. **Функция, извлекающая дескрипторы признаков из списка изображений.**
Данная функция проверяет, какой тип дескриптора был указан в параметре descriptor (sift или orb), 
создает соответствующий объект дескриптора, перебирает изображения, для каждого находит ключевые 
точки и вычисляет дескриптор для этих точек. Дескрипторы для всех ключевых точек изображения 
добавляются в список.

5. **Функция, создающая визуальный словарь из списка дескрипторов признаков с использованием 
алгоритма KMeans.**
Данная функция объединяет все дескрипторы признаков в одну матрицу признаков, создает объект 
KMeans с указанным количеством кластеров и фиксированным случайным состоянием. Далее алгоритм 
KMeans применяется к матрице признаков.

6. **Функция, создающая гистограмму визуальных слов.**
Данная функция создает нулевую гистограмму с количеством ячеек, равным количеству кластеров 
в визуальном словаре. Если дескриптор признаков не равен None, функция применяет алгоритм 
KMeans для предсказания кластера, к которому принадлежит каждый дескриптор. Для каждого 
предсказанного кластера функция увеличивает соответствующую ячейку в гистограмме на единицу.

7. **Функция, создающая векторы признаков для списка изображений.**
Данная функция перебирает изображения из списка, для каждого изображения функция извлекает 
дескрипторы признаков, создает гистограмму визуальных слов и добавляет её в список.

8. **Функция, обучающая классификатор.**
Данная функция проверяет указанный тип классификатора в параметре arg_classifier (svc, rf, 
knn, gb, lr), создает соответствующий объект классификатора и обучает созданный классификатор 
на данных.

9. **Функция, оценивающая производительность заданного классификатора.**
Данная функция вычисляет точность классификатора, сравнивая предсказанные метки с истинными 
метками.

10. **Функция, обучающая классификатор и оценивающая его точность.**
Данная функция извлекает дескрипторы признаков из обучающих изображений, создаёт визуальный 
словарь и векторы признаков для обучающих и тестовых изображений, обучает классификатор на 
векторах признаков и метках обучающих изображений и оценивает точность классификатора на 
векторах признаков и метках тестовых изображений.

11. **Функция, визуализирующая ключевые точки.**
Данная функция отображает 5 изображений с нарисованными на них ключевыми точками.